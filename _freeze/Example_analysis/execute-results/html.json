{
  "hash": "7cb2c28761ec8ec01eb8fcf903d407aa",
  "result": {
    "markdown": "---\ntitle: \"Example_analysis\"\neditor: visual\nbibliography: references.bib\nnocite: '@*'\ncsl: modern-language-association.csl\n---\n\n\n## Background\n\n![](board_games.jpg)\n[Image source: NBC News](https://www.nbcnews.com/select/shopping/best-board-games-play-quarantine-ncna1231447)\n\n### Motivation\nAs holiday season is approaching, there will be many occasion of gatherings with a group of friends (of various sizes). A gathering is more fun with board games, in addition to food and chatting. Here, I would like to figure out which game, from different categories (taking into considerations of personalities etc), is the most suited for hanging out with friends depending on party size, and ratings. Assuming that we're all above 21 years old.\n\nQuestions to be answered:\n1) Is there a relationship between max players and playing times across board games;\n2) What are the top3 most highly rated (average) games for each of the top10 highly rated (average) game categories?\n\n### Intended audience\n\nFor anyone, especially those above 21 years old, who is considering buying board games for gathering or parties. \n\n### Data Origin\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidytuesdayR)\n#library(here)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(tidyverse)\nlibrary(dplyr)\n#library(\"maps\")\n\n# saves data only once (not each time you knit a R Markdown)\nif(!file.exists(\"board_games.RDS\")) {\n  url_csv <- 'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-12/board_games.csv'\n  board_games <- readr::read_csv(url_csv)\n  \n  # save the file to RDS objects\n  saveRDS(board_games, file= \"board_games.RDS\")\n}\n```\n:::\n\n\n::: column-margin\nHere are some of the libraries I used in this analysis.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboard_games <- readRDS(\"board_games.RDS\")\nas_tibble(board_games)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10,532 × 22\n   game_id descrip…¹ image max_p…² max_p…³ min_age min_p…⁴ min_p…⁵ name  playi…⁶\n     <dbl> <chr>     <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>   <dbl>\n 1       1 Die Mach… //cf…       5     240      14       3     240 Die …     240\n 2       2 Dragonma… //cf…       4      30      12       3      30 Drag…      30\n 3       3 Part of … //cf…       4      60      10       2      30 Samu…      60\n 4       4 When you… //cf…       4      60      12       2      60 Tal …      60\n 5       5 In Acqui… //cf…       6      90      12       3      90 Acqu…      90\n 6       6 In the a… //cf…       6     240      12       2     240 Mare…     240\n 7       7 In Cathe… //cf…       2      20       8       2      20 Cath…      20\n 8       8 In this … //cf…       5     120      12       2     120 Lord…     120\n 9       9 Although… //cf…       4      90      13       2      90 El C…      90\n10      10 Elfenlan… //cf…       6      60      10       2      60 Elfe…      60\n# … with 10,522 more rows, 12 more variables: thumbnail <chr>,\n#   year_published <dbl>, artist <chr>, category <chr>, compilation <chr>,\n#   designer <chr>, expansion <chr>, family <chr>, mechanic <chr>,\n#   publisher <chr>, average_rating <dbl>, users_rated <dbl>, and abbreviated\n#   variable names ¹​description, ²​max_players, ³​max_playtime, ⁴​min_players,\n#   ⁵​min_playtime, ⁶​playing_time\n```\n:::\n:::\n\n\nThe data used in this analysis comes from [TidyTuesday](https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-03-12). The data originally comes from the [Board Game Geek](https://boardgamegeek.com) database. Specifically, it only contains games with at least 50 ratings and for games between 1950-2016, leaving us with 10,532 games.\nHere is a [data dictionary](https://github.com/rfordatascience/tidytuesday/blob/master/data/2022/2022-01-25/readme.md) explaining what each column name means.\n\n## Data wrangling\n\n\n#### 1. filter to retain board games that are assigned to only one category and retain game category that is not a NA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# head(board_games$category) \nboard_games$num_category_assigned <- unlist(lapply(str_split(board_games$category, \",\"), length))\nfiltered_board_games <- board_games %>% filter(num_category_assigned ==1) %>% drop_na(category)\n#glimpse(filtered_board_games) \n#unique(filtered_board_games$category)\n\n#unique(filtered_board_games$min_age)\n# [1] 12  8 13 10  9 14  6 11  7 16  5  0 15 18  4  3 21 \n```\n:::\n\n\nFiltering board games that are only assigned to one defined game category (i.e. categories without NAs), gives us a total of 1913 games, with 71 unique categories, from 1950-2016. \nTHIS IS THE _FINAL_ DATAFRAME USED FOR ALL DOWNSTREAM ANALYSES. Note also that people above 21 years old are eligible to play all games included in the datasets. \n\n#### 2. board games - relationship between max_players and playing time\n\n##### Question 1: Is there a relationship between playing time and maximum number of players across all board games?\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_board_games %>% filter(max_players<=25) %>% ggplot(aes(x=max_players, y=playing_time)) + geom_point() + geom_smooth() + xlab(\"Maximum number of players\") + ylab(\"Playing time (in minutes)\") + ggtitle(\"Fig.1 Relationship between playing time and max players\") + labs(subtitle=\"There is no clear relationship between max players and playing times across board games.\", caption=\"Siqi Chen\") + theme(\n  plot.title = element_text(color = \"black\", size = 16, face = \"bold\",hjust = 0.5),\n  plot.subtitle = element_text(color = \"black\"),\n  plot.caption = element_text(color = \"black\", face = \"italic\"))+ theme(axis.text=element_text(size=10),\n        axis.title=element_text(size=12), strip.text.x = element_text(size =10 ))\n```\n\n::: {.cell-output-display}\n![](Example_analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n#### 3. Board games - category & ratings \n\n::: {.callout-warning}\nFor this analysis, we only retain categories that have at least 10 games. \n::: \n\n##### Question 2: What are the rankings of average ratings across all categories from 1950-2016?\n\n::: {.cell}\n\n```{.r .cell-code}\ncategories_at_least_10_games <- filtered_board_games %>% group_by(category) %>% summarize(total_games=n()) %>% filter(total_games>=10) \n# Filtering out categories with less than 10 games leave us with 35 unique categories\n\ncategories_board_games_rating_rank <- filtered_board_games %>% filter(category %in% categories_at_least_10_games$category) %>% group_by(category) %>% summarise(mean_rating=mean(average_rating),median_rating=median(average_rating)) %>% arrange(desc(mean_rating))\n```\n:::\n\n\n\n##### Question 3: What are the three lowest and highest average rated categories of board games from 1950-2016?\n\n::: {.cell}\n\n```{.r .cell-code}\n# the top3 highest average rated board game categories from 1950-2016\ncategories_board_games_rating_rank %>% head(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  category    mean_rating median_rating\n  <chr>             <dbl>         <dbl>\n1 Renaissance        7.08          7.19\n2 Trains             6.70          6.79\n3 Medieval           6.56          6.63\n```\n:::\n\n```{.r .cell-code}\n# the least three average rated board game categories from 1950-2016\ncategories_board_games_rating_rank %>% tail(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  category        mean_rating median_rating\n  <chr>                 <dbl>         <dbl>\n1 Children's Game        5.91          5.99\n2 Pirates                5.86          6.06\n3 Trivia                 5.21          5.25\n```\n:::\n:::\n\n\n##### Question 4: How does the average rating changes over time for the top10 overall highest average rated categories of board games from 1950-2016?\n\n::: {.callout-note}\n\nLet's figure out which are the top 10 highest rated categories on average from 1950-2016. \n\n::: \n\n::: {.cell}\n\n```{.r .cell-code}\ntop10_categories <- categories_board_games_rating_rank %>% head(n=10) %>% pull(category) \n\nrating_by_category <- filtered_board_games %>% filter(category %in% top10_categories) %>% select(name,max_players, category, year_published, average_rating, max_playtime) \n\n\ncategory_ordered <- with(rating_by_category, reorder(category, average_rating, median))\nrating_by_category_ordered <- rating_by_category\nrating_by_category_ordered$category <- factor(rating_by_category_ordered$category, levels = levels(category_ordered))\nggplot(rating_by_category_ordered,aes(x=category, y=average_rating)) + geom_boxplot() + scale_x_discrete(guide = guide_axis(n.dodge=2)) + xlab(\"Board game category\") + ylab(\"Average rating\") + ggtitle(\"Fig.2 Average rating across the top10 highest rated categories\") + theme_bw() +\n  labs(subtitle=\"Renaissance category has the highest average rating (above 7).\\nThe other top10 categories have a median average rating around 6.2-6.8 with different spread.\", caption=\"Siqi Chen\") + theme(\n  plot.title = element_text(color = \"black\", size = 16, face = \"bold\",hjust = 0.5),\n  plot.subtitle = element_text(color = \"black\"),\n  plot.caption = element_text(color = \"black\", face = \"italic\") \n) + theme(strip.text.x = element_text(size =10 ))\n```\n\n::: {.cell-output-display}\n![](Example_analysis_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nThen plot the average rating of games over time from 1950-2016, stratified by categories. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_board_games %>% \n  filter(category %in% top10_categories) %>% \n  select(c(name, year_published, category, average_rating)) %>% \n  ggplot(aes(x=year_published, y=average_rating)) + \n  geom_point() + geom_smooth(method=\"lm\", alpha=0.5) + \n  facet_wrap(~category, ncol=3, scales=\"free_y\") + \n  xlab(\"Game published year\") + ylab(\"Game average rating\") + ggtitle(\"Fig.3 Scatter plot for mean rating of games over time (by category)\") + theme_bw() + labs(subtitle=\"For most of the top10 highest rated categories, average rating of games generally increases over time.\\nFor Renaissance and Terroritty category, the average rating of the games fluctuates more and the \\nquality of different games do not always improve over time\", caption=\"Siqi Chen\") + theme(\n  plot.title = element_text(color = \"black\", size = 15, face = \"bold\",hjust = 0.5),\n  plot.subtitle = element_text(color = \"black\"),\n  plot.caption = element_text(color = \"black\", face = \"italic\") \n) + theme(strip.text.x = element_text(size =10 ))\n```\n\n::: {.cell-output-display}\n![](Example_analysis_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n#### 4. Within each board game category - max players and average_rating\n\n::: {.cell}\n\n```{.r .cell-code}\nrating_by_category_top3 <- rating_by_category %>% \n  filter(max_players<=16) %>% \n  group_by(category) %>%\n  top_n(n=3, wt=average_rating) \n\nggplot(rating_by_category_top3,aes(x=max_players, y=average_rating)) + \n  geom_point() + \n  geom_text(label=rating_by_category_top3$name,check_overlap = T,hjust=0, vjust=0, size=1.8) + \n  facet_wrap(category~., scales=\"free_y\") + coord_cartesian(xlim = c(0, 8)) + \n  scale_color_identity() + \n  theme(strip.text.x = element_text(size =10 )) + xlab(\"Maximum number of players\") + ylab(\"Average rating\") + ggtitle(\"Fig.4 Top3 average rated games across top10 highly rated categories\") + theme_bw() + labs(subtitle=\"All top3 games from each top10 category have an average rating above 7, except 'Shitenno from \\n'Territory Building'. Across all categories, most games have a maximum of 4-6 players, except that \\nfor sports, where maximum number of player is 2.\", caption=\"Siqi Chen\") + theme(\n  plot.title = element_text(color = \"black\", size = 14, face = \"bold\",hjust = 0.5),\n  plot.subtitle = element_text(color = \"black\"),\n  plot.caption = element_text(color = \"black\", face = \"italic\") \n) + theme(strip.text.x = element_text(size =10 ))\n```\n\n::: {.cell-output-display}\n![](Example_analysis_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n## Summary (4-6 sentences)\n1. There is no clear relationship between max players and playing times across board games. This makes sense since playing time can also depends on many other factors, e.g. complexity of the game. \n\n2. Renaissance and Trains categories are the top2 highly rated (mean and median) categories, with an average rating above 6.7.\n\n3. Within each top10 highly rated (average) categories, I have figured out the top3 most highly rated (average) games (Fig.4). we can pick games, depending on people's preferences, and the number of people based on this graph.\n\n## Functions used\n| **`dplyr`**   | **`tidyr`** | **`ggplot2`**      |\n|---------------|-------------|--------------------|\n| `mutate()`    | `drop_na()` | `geom_point()`     |\n| `select()`    |             | `geom_smooth()`    |\n| `group_by()`  |             | `geom_text()`      |\n| `arrange()`   |             | `geom_boxplot()`   |\n| `summarize()` |             |                    |\n\n## References\n::: {#refs}\n:::\n\n\n",
    "supporting": [
      "Example_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}